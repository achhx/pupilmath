<!DOCTYPE html>
<html>
<head>
    <title>四则运算练习</title>
    <style>
        .container { max-width: 800px; margin: 20px auto; padding: 20px }
        .question { font-size: 24px; margin: 20px 0 }
        .explanation { 
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
            background: #f8f9fa;
            padding: 0 15px;
        }
        .step { margin: 10px 0; opacity: 0; transform: translateY(20px); }
        .show { max-height: 500px; }
        .animate-step { 
            animation: slideIn 0.5s forwards;
            animation-delay: calc(var(--i)*0.3s);
        }
        @keyframes slideIn {
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div class="container">
        <select id="level">
            <option value="1">初级（加减）</option>
            <option value="2">中级（乘除）</option>
            <option value="3">高级（混合运算）</option>
        </select>
        <div id="questionArea"></div>
        <input type="number" step="0.01" id="answer">
        <button onclick="checkAnswer()">提交答案</button>
        <div id="feedback"></div>
    </div>

<script>
let currentQuestion = null;

function generateQuestion(level) {
    let ops = [];
    if(level >= 1) ops.push('+',  '-');
    if(level >= 2) ops.push('×',  '÷');
    if(level >= 3) ops = ['+', '-', '×', '÷'];
    
    const num1 = Math.floor(Math.random()*10)+1; 
    const num2 = Math.floor(Math.random()*10)+1; 
    const op = ops[Math.floor(Math.random()*ops.length)];
    
    return {
        expression: `${num1} ${op} ${num2}`,
        answer: calculate(num1, op, num2),
        steps: buildSteps(num1, op, num2)
    };
}

function calculate(a, op, b) {
    switch(op) {
        case '+': return a + b;
        case '-': return a > b ? a - b : b - a;
        case '×': return a * b;
        case '÷': return (a / b).toFixed(2);
    }
}

function buildSteps(a, op, b) {
    const steps = [];
    switch(op) {
        case '+':
            steps.push(`${a}  加 ${b} 等于 ${a + b}`);
            break;
        case '-':
            steps.push(` 先比较大小：${Math.max(a,  b)} - ${Math.min(a,  b)}`);
            steps.push(` 计算结果：${Math.abs(a  - b)}`);
            break;
        case '×':
            steps.push(`${a}  × ${b} = ${a * b}`);
            break;
        case '÷':
            steps.push(`${a}  ÷ ${b} = ${(a/b).toFixed(2)}（保留两位小数）`);
            break;
    }
    return steps;
}

function showQuestion() {
    const level = document.getElementById('level').value; 
    currentQuestion = generateQuestion(parseInt(level));
    document.getElementById('questionArea').innerHTML  = `
        <div class="question">${currentQuestion.expression}  = ?</div>
    `;
}

function checkAnswer() {
    const userAnswer = parseFloat(document.getElementById('answer').value); 
    const correctAnswer = parseFloat(currentQuestion.answer); 
    const feedback = document.getElementById('feedback'); 
    
    if(Math.abs(userAnswer  - correctAnswer) < 0.01) {
        feedback.innerHTML  = "<p style='color:green'>✅ 回答正确！</p>";
    } else {
        feedback.innerHTML  = `
            <p style='color:red'>❌ 正确答案是 ${correctAnswer}</p>
            <div class="explanation">
                ${currentQuestion.steps.map((s,i)  => 
                    `<p class="step" style="--i:${i}">${s}</p>`
                ).join('')}
            </div>
        `;
        setTimeout(() => {
            feedback.querySelector('.explanation').classList.add('show'); 
            document.querySelectorAll('.step').forEach(el  => 
                el.classList.add('animate-step') 
            );
        }, 100);
    }
    setTimeout(showQuestion, 2000);
}

// 初始化题目
showQuestion();
</script>
</body>
</html>
